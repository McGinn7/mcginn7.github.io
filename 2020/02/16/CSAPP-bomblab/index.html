<!DOCTYPE html>
<html lang="">
    <!-- title -->




<!-- keywords -->




<head><meta name="generator" content="Hexo 3.9.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Mcginn">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Mcginn">
    
    <meta name="keywords" content="hexo,mcginn,mcginn7,ICPC,hexo-theme,hexo-blog">
    
    <meta name="description" content>
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>CSAPP - bomblab · Mcginn&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("../../../../font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href="../../../../css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="../../../../css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href="../../../../assets/m.ico">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script">
    <link rel="preload" href="../../../../scripts/main.js" as="script">
    <link rel="preload" as="font" href="../../../../font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
</head>

    
        <body class="post-body">
    
    
<!-- hexo-inject:begin --><!-- hexo-inject:end --><header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="../../../../index.html" >Mcginn&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">CSAPP - bomblab</a>
            </div>
    </div>
    
    <a class="home-link" href=/>Mcginn's Blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(../../../../intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            CSAPP - bomblab
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">4.7k</span>阅读时长: <span class="post-count reading-time">24 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2020/02/16</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "../../../../lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="../../../../assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h2 id="安装-GDB"><a href="#安装-GDB" class="headerlink" title="安装 GDB"></a>安装 GDB</h2><h3 id="问题一"><a href="#问题一" class="headerlink" title="问题一"></a>问题一</h3><p>在 Ubuntu 18.04 LTS 中使用 <code>apt-get install gdb</code> 安装失败。替换使用国内 Ubuntu 的镜像源后安装成功。</p>
<ol>
<li><p>首先更新 <code>/etc/apt/sources.list</code>，将该文件内容替换为阿里源：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>apt-get update</code> 和 <code>apt-get upgrade</code> 更新。</p>
</li>
<li><p>安装 gdb：<code>apt-get install gdb</code>。</p>
</li>
</ol>
<h3 id="问题二"><a href="#问题二" class="headerlink" title="问题二"></a>问题二</h3><p>执行 gdb 调试时，遇到 Error disabling address space randomization 错误，参考 <a href="https://stackoverflow.com/questions/35860527/warning-error-disabling-address-space-randomization-operation-not-permitted" target="_blank" rel="noopener">warning: Error disabling address space randomization: Operation not permitted</a>，在创建 docker 容器时添加 <code>--security-opt seccomp=unconfined</code> 参数：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --cap-add=SYS_PTRACE --security-opt seccomp=unconfined ubuntu bash</span><br></pre></td></tr></table></figure>
<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><h3 id="phase-1"><a href="#phase-1" class="headerlink" title="phase_1"></a>phase_1</h3><p>调用 <code>disassemble phase_1</code> 反汇编函数 phase_1 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0x400ee0 &lt;+0&gt;:     sub    $0x8,%rsp</span><br><span class="line">0x400ee4 &lt;+4&gt;:     mov    $0x402400,%esi</span><br><span class="line">0x400ee9 &lt;+9&gt;:     callq  0x401338 &lt;strings_not_equal&gt;</span><br><span class="line">0x400eee &lt;+14&gt;:    test   %eax,%eax</span><br><span class="line">0x400ef0 &lt;+16&gt;:    je     0x400ef7 &lt;phase_1+23&gt;</span><br><span class="line">0x400ef2 &lt;+18&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x400ef7 &lt;+23&gt;:    add    $0x8,%rsp</span><br><span class="line">0x400efb &lt;+27&gt;:    retq</span><br></pre></td></tr></table></figure>
<p>显然，该函数调用了函数 <code>strings_not_equal</code>，判断两个字符串是否相同。第一个字符串参数 %rdi  为输入 <code>input</code> 的地址，第二个参数为比较字符串的地址 0x402400。</p>
<p>在 gdb 中调用 <code>print (char *) 0x402400</code> 输出该地址的字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Border relations with Canada have never been better.</span><br></pre></td></tr></table></figure>
<p>因此 bomb 的第 1 组运行参数为上述字符串。</p>
<h3 id="phase-2"><a href="#phase-2" class="headerlink" title="phase_2"></a>phase_2</h3><p>调用 <code>disassemble phase_2</code> 反汇编函数 phase_2 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">0x400efc &lt;+0&gt;:     push   %rbp</span><br><span class="line">0x400efd &lt;+1&gt;:     push   %rbx</span><br><span class="line">0x400efe &lt;+2&gt;:     sub    $0x28,%rsp</span><br><span class="line">0x400f02 &lt;+6&gt;:     mov    %rsp,%rsi</span><br><span class="line">0x400f05 &lt;+9&gt;:     callq  0x40145c &lt;read_six_numbers&gt;</span><br><span class="line">0x400f0a &lt;+14&gt;:    cmpl   $0x1,(%rsp)</span><br><span class="line">0x400f0e &lt;+18&gt;:    je     0x400f30 &lt;phase_2+52&gt;</span><br><span class="line">0x400f10 &lt;+20&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x400f15 &lt;+25&gt;:    jmp    0x400f30 &lt;phase_2+52&gt;</span><br><span class="line">0x400f17 &lt;+27&gt;:    mov    -0x4(%rbx),%eax</span><br><span class="line">0x400f1a &lt;+30&gt;:    add    %eax,%eax</span><br><span class="line">0x400f1c &lt;+32&gt;:    cmp    %eax,(%rbx)</span><br><span class="line">0x400f1e &lt;+34&gt;:    je     0x400f25 &lt;phase_2+41&gt;</span><br><span class="line">0x400f20 &lt;+36&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x400f25 &lt;+41&gt;:    add    $0x4,%rbx</span><br><span class="line">0x400f29 &lt;+45&gt;:    cmp    %rbp,%rbx</span><br><span class="line">0x400f2c &lt;+48&gt;:    jne    0x400f17 &lt;phase_2+27&gt;</span><br><span class="line">0x400f2e &lt;+50&gt;:    jmp    0x400f3c &lt;phase_2+64&gt;</span><br><span class="line">0x400f30 &lt;+52&gt;:    lea    0x4(%rsp),%rbx</span><br><span class="line">0x400f35 &lt;+57&gt;:    lea    0x18(%rsp),%rbp</span><br><span class="line">0x400f3a &lt;+62&gt;:    jmp    0x400f17 &lt;phase_2+27&gt;</span><br><span class="line">0x400f3c &lt;+64&gt;:    add    $0x28,%rsp</span><br><span class="line">0x400f40 &lt;+68&gt;:    pop    %rbx</span><br><span class="line">0x400f41 &lt;+69&gt;:    pop    %rbp</span><br><span class="line">0x400f42 &lt;+70&gt;:    retq</span><br></pre></td></tr></table></figure>
<p>最先调用了函数 <code>read_six_numbers</code>，其起始地址为 0x40145c，调用 <code>disassemble 0x40145c</code> 反汇编其代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">0x40145c &lt;+0&gt;:     sub    $0x18,%rsp</span><br><span class="line">0x401460 &lt;+4&gt;:     mov    %rsi,%rdx</span><br><span class="line">0x401463 &lt;+7&gt;:     lea    0x4(%rsi),%rcx</span><br><span class="line">0x401467 &lt;+11&gt;:    lea    0x14(%rsi),%rax</span><br><span class="line">0x40146b &lt;+15&gt;:    mov    %rax,0x8(%rsp)</span><br><span class="line">0x401470 &lt;+20&gt;:    lea    0x10(%rsi),%rax</span><br><span class="line">0x401474 &lt;+24&gt;:    mov    %rax,(%rsp)</span><br><span class="line">0x401478 &lt;+28&gt;:    lea    0xc(%rsi),%r9</span><br><span class="line">0x40147c &lt;+32&gt;:    lea    0x8(%rsi),%r8</span><br><span class="line">0x401480 &lt;+36&gt;:    mov    $0x4025c3,%esi</span><br><span class="line">0x401485 &lt;+41&gt;:    mov    $0x0,%eax</span><br><span class="line">0x40148a &lt;+46&gt;:    callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x40148f &lt;+51&gt;:    cmp    $0x5,%eax</span><br><span class="line">0x401492 &lt;+54&gt;:    jg     0x401499 &lt;read_six_numbers+61&gt;</span><br><span class="line">0x401494 &lt;+56&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x401499 &lt;+61&gt;:    add    $0x18,%rsp</span><br><span class="line">0x40149d &lt;+65&gt;:    retq</span><br></pre></td></tr></table></figure>
<p>先注意该函数调用了 <code>sscanf</code> 函数，其从一个字符串而不是标准输入流读取输入。<code>sscanf</code> 的第二个参数为输入格式，尝试打印其字符串（0x4025c3）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$1 = 0x4025c3 &quot;%d %d %d %d %d %d&quot;</span><br></pre></td></tr></table></figure>
<p>与函数名相应，该函数从输入 <code>input</code> 中读取 6 个整数。</p>
<p>由于<code>sscanf</code> 参数超过 6 个，前 6 个参数<strong>按序</strong>分别存储于 %edi, %esi, %rdx, %rcx, %r8, %r9，剩余两个参数存储于栈中，其中第 7 个参数位于栈顶。阅读代码可知 6 个整数按序存储于 %rsi, %rsi + 4, …, %rsi + 20。</p>
<p>0x400f0a 行的代码表示读入的第 1 个数必须等于 1。</p>
<p>从 0x400f17 到 0x400f2c 的代码表示，*(rbp) = *(rbp - 0x4) * 2，即读入的 6 个整数表示首项为 1 公比为 2 的等比数列： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 2 4 8 16 32</span><br></pre></td></tr></table></figure>
<p>该序列为 bomb 的第 2 组运行参数。</p>
<h3 id="phase-3"><a href="#phase-3" class="headerlink" title="phase_3"></a>phase_3</h3><p>调用 <code>disassemble phase_3</code> 反汇编函数 phase_3 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">0x400f43 &lt;+0&gt;:     sub    $0x18,%rsp</span><br><span class="line">0x400f47 &lt;+4&gt;:     lea    0xc(%rsp),%rcx</span><br><span class="line">0x400f4c &lt;+9&gt;:     lea    0x8(%rsp),%rdx</span><br><span class="line">0x400f51 &lt;+14&gt;:    mov    $0x4025cf,%esi</span><br><span class="line">0x400f56 &lt;+19&gt;:    mov    $0x0,%eax</span><br><span class="line">0x400f5b &lt;+24&gt;:    callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x400f60 &lt;+29&gt;:    cmp    $0x1,%eax</span><br><span class="line">0x400f63 &lt;+32&gt;:    jg     0x400f6a &lt;phase_3+39&gt;</span><br><span class="line">0x400f65 &lt;+34&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x400f6a &lt;+39&gt;:    cmpl   $0x7,0x8(%rsp)</span><br><span class="line">0x400f6f &lt;+44&gt;:    ja     0x400fad &lt;phase_3+106&gt;</span><br><span class="line">0x400f71 &lt;+46&gt;:    mov    0x8(%rsp),%eax</span><br><span class="line">0x400f75 &lt;+50&gt;:    jmpq   *0x402470(,%rax,8)</span><br><span class="line">0x400f7c &lt;+57&gt;:    mov    $0xcf,%eax</span><br><span class="line">0x400f81 &lt;+62&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400f83 &lt;+64&gt;:    mov    $0x2c3,%eax</span><br><span class="line">0x400f88 &lt;+69&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400f8a &lt;+71&gt;:    mov    $0x100,%eax</span><br><span class="line">0x400f8f &lt;+76&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400f91 &lt;+78&gt;:    mov    $0x185,%eax</span><br><span class="line">0x400f96 &lt;+83&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400f98 &lt;+85&gt;:    mov    $0xce,%eax</span><br><span class="line">0x400f9d &lt;+90&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400f9f &lt;+92&gt;:    mov    $0x2aa,%eax</span><br><span class="line">0x400fa4 &lt;+97&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400fa6 &lt;+99&gt;:    mov    $0x147,%eax</span><br><span class="line">0x400fab &lt;+104&gt;:   jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400fad &lt;+106&gt;:   callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x400fb2 &lt;+111&gt;:   mov    $0x0,%eax</span><br><span class="line">0x400fb7 &lt;+116&gt;:   jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x400fb9 &lt;+118&gt;:   mov    $0x137,%eax</span><br><span class="line">0x400fbe &lt;+123&gt;:   cmp    0xc(%rsp),%eax</span><br><span class="line">0x400fc2 &lt;+127&gt;:   je     0x400fc9 &lt;phase_3+134&gt;</span><br><span class="line">0x400fc4 &lt;+129&gt;:   callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x400fc9 &lt;+134&gt;:   add    $0x18,%rsp</span><br><span class="line">0x400fcd &lt;+138&gt;:   retq</span><br></pre></td></tr></table></figure>
<p>首先看函数 <code>sscanf</code> 的调用：0x4025cf 地址字符串为 <code>$2 = 0x4025cf &quot;%d %d&quot;</code>，从 <code>input</code> 读取两个整数，分别存储于地址 0x8(%rsp) 和 0xc(%rsp)。</p>
<p><code>cmpl $0x7,0x8(%rsp)</code>  和 <code>ja 0x400fad &lt;phase_3+106&gt;</code> 表明，第一个整数的值不能超过 7。</p>
<p><code>jmpq *0x402470(,%rax,8)</code> 表示跳转到 <em>(0x402470 + 8 </em> %rax) 处，而 %rax 的值此时等于读取的第一个整数。假设输入的第一个整数为 0，下一个指令的地址为 0x402470，使用 <code>print /x *0x402470</code> 打印出地址的值为 0x400f7c，即指令 <code>jmpq *0x402470(,%rax,8)</code> 等同于 <code>jmpq 0x400f7c</code>。地址为 0x400f7c 的指令为 <code>mov $0xcf,%eax</code>，随后跳转到 <code>cmp 0xc(%rsp),%eax</code>，即与输入的第二个整数比较，相同时结束该函数调用。说明当输入为 0 207 时（0xcf = 207），<code>phase_3</code> 不会爆炸。</p>
<p>对于第 1 个整数分别为 1~7 时，其推理过程也是类似的，其结果如下表：</p>
<p><style type="text/css"><br>.tg  {border-collapse:collapse;border-spacing:0;border:none;border-color:#aaa;}<br>.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-color:#aaa;color:#333;background-color:#fff;}<br>.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-color:#aaa;color:#fff;background-color:#f38630;}<br>.tg .tg-vswx{background-color:#fd6864;border-color:inherit;text-align:center;vertical-align:top}<br>.tg .tg-c3ow{border-color:inherit;text-align:center;vertical-align:top}
</style></p>
<table class="tg">
  <tr>
    <th class="tg-vswx">数1</th>
    <th class="tg-vswx">下条指令地址</th>
    <th class="tg-vswx">跳转地址</th>
    <th class="tg-vswx">数2（16进制）</th>
    <th class="tg-vswx">数2（10进制）</th>
  </tr>
  <tr>
    <td class="tg-c3ow">0</td>
    <td class="tg-c3ow">0x402470</td>
    <td class="tg-c3ow">0x400f7c</td>
    <td class="tg-c3ow">0xcf</td>
    <td class="tg-c3ow">207</td>
  </tr>
  <tr>
    <td class="tg-c3ow">1</td>
    <td class="tg-c3ow">0x402478</td>
    <td class="tg-c3ow">0x400fb9</td>
    <td class="tg-c3ow">0x137</td>
    <td class="tg-c3ow">311</td>
  </tr>
  <tr>
    <td class="tg-c3ow">2</td>
    <td class="tg-c3ow">0x402480</td>
    <td class="tg-c3ow">0x400f83</td>
    <td class="tg-c3ow">0x2c3</td>
    <td class="tg-c3ow">707</td>
  </tr>
  <tr>
    <td class="tg-c3ow">3</td>
    <td class="tg-c3ow">0x402488</td>
    <td class="tg-c3ow">0x400f8a</td>
    <td class="tg-c3ow">0x100</td>
    <td class="tg-c3ow">256</td>
  </tr>
  <tr>
    <td class="tg-c3ow">4</td>
    <td class="tg-c3ow">0x402490</td>
    <td class="tg-c3ow">0x400f91</td>
    <td class="tg-c3ow">0x185</td>
    <td class="tg-c3ow">389</td>
  </tr>
  <tr>
    <td class="tg-c3ow">5</td>
    <td class="tg-c3ow">0x402498</td>
    <td class="tg-c3ow">0x400f98</td>
    <td class="tg-c3ow">0xce</td>
    <td class="tg-c3ow">206</td>
  </tr>
  <tr>
    <td class="tg-c3ow">6</td>
    <td class="tg-c3ow">0x4024a0</td>
    <td class="tg-c3ow">0x400f9f</td>
    <td class="tg-c3ow">0x2aa</td>
    <td class="tg-c3ow">682</td>
  </tr>
</table>

<p>每对&lt;数1，数2&gt;均可作为 bomb 的第 3 组参数。</p>
<h3 id="phase-4"><a href="#phase-4" class="headerlink" title="phase_4"></a>phase_4</h3><p>调用 <code>disassemble phase_4</code> 反汇编函数 phase_4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0x40100c &lt;+0&gt;:     sub    $0x18,%rsp</span><br><span class="line">0x401010 &lt;+4&gt;:     lea    0xc(%rsp),%rcx</span><br><span class="line">0x401015 &lt;+9&gt;:     lea    0x8(%rsp),%rdx</span><br><span class="line">0x40101a &lt;+14&gt;:    mov    $0x4025cf,%esi</span><br><span class="line">0x40101f &lt;+19&gt;:    mov    $0x0,%eax</span><br><span class="line">0x401024 &lt;+24&gt;:    callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x401029 &lt;+29&gt;:    cmp    $0x2,%eax</span><br><span class="line">0x40102c &lt;+32&gt;:    jne    0x401035 &lt;phase_4+41&gt;</span><br><span class="line">0x40102e &lt;+34&gt;:    cmpl   $0xe,0x8(%rsp)</span><br><span class="line">0x401033 &lt;+39&gt;:    jbe    0x40103a &lt;phase_4+46&gt;</span><br><span class="line">0x401035 &lt;+41&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x40103a &lt;+46&gt;:    mov    $0xe,%edx</span><br><span class="line">0x40103f &lt;+51&gt;:    mov    $0x0,%esi</span><br><span class="line">0x401044 &lt;+56&gt;:    mov    0x8(%rsp),%edi</span><br><span class="line">0x401048 &lt;+60&gt;:    callq  0x400fce &lt;func4&gt;</span><br><span class="line">0x40104d &lt;+65&gt;:    test   %eax,%eax</span><br><span class="line">0x40104f &lt;+67&gt;:    jne    0x401058 &lt;phase_4+76&gt;</span><br><span class="line">0x401051 &lt;+69&gt;:    cmpl   $0x0,0xc(%rsp)</span><br><span class="line">0x401056 &lt;+74&gt;:    je     0x40105d &lt;phase_4+81&gt;</span><br><span class="line">0x401058 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x40105d &lt;+81&gt;:    add    $0x18,%rsp</span><br><span class="line">0x401061 &lt;+85&gt;:    retq</span><br></pre></td></tr></table></figure>
<ol>
<li><p>首先看读入部分，相关代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0x40100c &lt;+0&gt;:     sub    $0x18,%rsp</span><br><span class="line">0x401010 &lt;+4&gt;:     lea    0xc(%rsp),%rcx</span><br><span class="line">0x401015 &lt;+9&gt;:     lea    0x8(%rsp),%rdx</span><br><span class="line">0x40101a &lt;+14&gt;:    mov    $0x4025cf,%esi</span><br><span class="line">0x40101f &lt;+19&gt;:    mov    $0x0,%eax</span><br><span class="line">0x401024 &lt;+24&gt;:    callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x401029 &lt;+29&gt;:    cmp    $0x2,%eax</span><br><span class="line">0x40102c &lt;+32&gt;:    jne    0x401035 &lt;phase_4+41&gt;</span><br></pre></td></tr></table></figure>
<p>函数 sscanf 的参数一为 %rdi，存储输入 input 的地址；参数二为 %esi，使用 <code>(gdb) print （char *) 0x4025cf</code> 查看该地址的字符串，其值为 “%d %d” 表示读入两个整数；参数三为 %rdx=%rsp+0x8, 参数四为 %rcx=%rsp + %c，说明读入的两个整数分别存储于地址 %rsp+0x8 和 %rsp+0xc。</p>
<p>%eax 表示读入的整数数量，如果不为 2 则跳转到调用 explode_bomb 函数的指令地址。</p>
</li>
<li><p>接下来，程序准备调用函数 func4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0x40102e &lt;+34&gt;:    cmpl   $0xe,0x8(%rsp)</span><br><span class="line">0x401033 &lt;+39&gt;:    jbe    0x40103a &lt;phase_4+46&gt;</span><br><span class="line">0x401035 &lt;+41&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x40103a &lt;+46&gt;:    mov    $0xe,%edx</span><br><span class="line">0x40103f &lt;+51&gt;:    mov    $0x0,%esi</span><br><span class="line">0x401044 &lt;+56&gt;:    mov    0x8(%rsp),%edi</span><br><span class="line">0x401048 &lt;+60&gt;:    callq  0x400fce &lt;func4&gt;</span><br></pre></td></tr></table></figure>
<p>0x40102e~0x401035（1~3 行）：要求读入的第一个整数必须 ≤14。</p>
<p>0x40103a~0x401044（4~6 行）：构造 func4 参数：第一个整数，0，14，即调用函数 func4(数一，0，14)。</p>
</li>
<li><p>处理函数 func4 的返回值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x40104d &lt;+65&gt;:    test   %eax,%eax</span><br><span class="line">0x40104f &lt;+67&gt;:    jne    0x401058 &lt;phase_4+76&gt;</span><br></pre></td></tr></table></figure>
<p>如果 func4() 返回值不等于 0，则跳转并调用 explode_bomb。</p>
</li>
<li><p>处理读入的第二个整数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x401051 &lt;+69&gt;:    cmpl   $0x0,0xc(%rsp)</span><br><span class="line">0x401056 &lt;+74&gt;:    je     0x40105d &lt;phase_4+81&gt;</span><br><span class="line">0x401058 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x40105d &lt;+81&gt;:    add    $0x18,%rsp</span><br><span class="line">0x401061 &lt;+85&gt;:    retq</span><br></pre></td></tr></table></figure>
<p>如果<strong>数二等于 0</strong>，则跳转指令并结束；否则调用 explode_bomb。</p>
</li>
<li><p>调用 <code>disassemble func4</code> 反汇编函数 func4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0x400fce &lt;+0&gt;:     sub    $0x8,%rsp</span><br><span class="line">0x400fd2 &lt;+4&gt;:     mov    %edx,%eax</span><br><span class="line">0x400fd4 &lt;+6&gt;:     sub    %esi,%eax</span><br><span class="line">0x400fd6 &lt;+8&gt;:     mov    %eax,%ecx</span><br><span class="line">0x400fd8 &lt;+10&gt;:    shr    $0x1f,%ecx</span><br><span class="line">0x400fdb &lt;+13&gt;:    add    %ecx,%eax</span><br><span class="line">0x400fdd &lt;+15&gt;:    sar    %eax</span><br><span class="line">0x400fdf &lt;+17&gt;:    lea    (%rax,%rsi,1),%ecx</span><br><span class="line">0x400fe2 &lt;+20&gt;:    cmp    %edi,%ecx</span><br><span class="line">0x400fe4 &lt;+22&gt;:    jle    0x400ff2 &lt;func4+36&gt;</span><br><span class="line">0x400fe6 &lt;+24&gt;:    lea    -0x1(%rcx),%edx</span><br><span class="line">0x400fe9 &lt;+27&gt;:    callq  0x400fce &lt;func4&gt;</span><br><span class="line">0x400fee &lt;+32&gt;:    add    %eax,%eax</span><br><span class="line">0x400ff0 &lt;+34&gt;:    jmp    0x401007 &lt;func4+57&gt;</span><br><span class="line">0x400ff2 &lt;+36&gt;:    mov    $0x0,%eax</span><br><span class="line">0x400ff7 &lt;+41&gt;:    cmp    %edi,%ecx</span><br><span class="line">0x400ff9 &lt;+43&gt;:    jge    0x401007 &lt;func4+57&gt;</span><br><span class="line">0x400ffb &lt;+45&gt;:    lea    0x1(%rcx),%esi</span><br><span class="line">0x400ffe &lt;+48&gt;:    callq  0x400fce &lt;func4&gt;</span><br><span class="line">0x401003 &lt;+53&gt;:    lea    0x1(%rax,%rax,1),%eax</span><br><span class="line">0x401007 &lt;+57&gt;:    add    $0x8,%rsp</span><br><span class="line">0x40100b &lt;+61&gt;:    retq</span><br></pre></td></tr></table></figure>
<p>在第 2 步中已知 func4 的三个参数为整数，因此这里将 func4 定义为 <code>int func4(int a, int b, int c)</code>，其中 %edi = a, %esi = b, %edx = c。</p>
<p>0x400fd2~0x400fdf（2~8 行）：%eax = (c - b) / 2, %ecx = b + (c - b) / 2。记 m = b + (c - b) / 2，为区间 [b, c] 的中点。</p>
<p>0x400fe2~0x400fe4（9-10 行）：如果 %ecx &lt;= %edi（即 m &lt;= a），则跳转到 0x400ff2。</p>
<p>a. 不跳转时，执行 0x400fe6~0x400ff0（11~14 行）：调用并返回结果值 2 * func4(a, b, m - 1)。</p>
<p>b. 发生跳转，执行 0x400ff2~0x400ff9（15~17 行）：如果 %ecx &gt;= %edi（即 m &gt;= a），返回结果值 0，否咋调用并返回 2 * func(a, m + 1, c) + 1。</p>
<p>依据第 3 步的推论，func4(数 1, 0, 14) 的结果必须为 0，因此<strong>数一等于 7</strong>。</p>
</li>
</ol>
<p>因此 7 0 为 bomb 的第 4 组运行参数。</p>
<h3 id="phase-5"><a href="#phase-5" class="headerlink" title="phase_5"></a>phase_5</h3><p>调用 <code>disassemble phase_5</code> 反汇编函数 phase_5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">0x401062 &lt;+0&gt;:     push   %rbx</span><br><span class="line">0x401063 &lt;+1&gt;:     sub    $0x20,%rsp</span><br><span class="line">0x401067 &lt;+5&gt;:     mov    %rdi,%rbx</span><br><span class="line">0x40106a &lt;+8&gt;:     mov    %fs:0x28,%rax</span><br><span class="line">0x401073 &lt;+17&gt;:    mov    %rax,0x18(%rsp)</span><br><span class="line">0x401078 &lt;+22&gt;:    xor    %eax,%eax</span><br><span class="line">0x40107a &lt;+24&gt;:    callq  0x40131b &lt;string_length&gt;</span><br><span class="line">0x40107f &lt;+29&gt;:    cmp    $0x6,%eax</span><br><span class="line">0x401082 &lt;+32&gt;:    je     0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">0x401084 &lt;+34&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x401089 &lt;+39&gt;:    jmp    0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">0x40108b &lt;+41&gt;:    movzbl (%rbx,%rax,1),%ecx</span><br><span class="line">0x40108f &lt;+45&gt;:    mov    %cl,(%rsp)</span><br><span class="line">0x401092 &lt;+48&gt;:    mov    (%rsp),%rdx</span><br><span class="line">0x401096 &lt;+52&gt;:    and    $0xf,%edx</span><br><span class="line">0x401099 &lt;+55&gt;:    movzbl 0x4024b0(%rdx),%edx</span><br><span class="line">0x4010a0 &lt;+62&gt;:    mov    %dl,0x10(%rsp,%rax,1)</span><br><span class="line">0x4010a4 &lt;+66&gt;:    add    $0x1,%rax</span><br><span class="line">0x4010a8 &lt;+70&gt;:    cmp    $0x6,%rax</span><br><span class="line">0x4010ac &lt;+74&gt;:    jne    0x40108b &lt;phase_5+41&gt;</span><br><span class="line">0x4010ae &lt;+76&gt;:    movb   $0x0,0x16(%rsp)</span><br><span class="line">0x4010b3 &lt;+81&gt;:    mov    $0x40245e,%esi</span><br><span class="line">0x4010b8 &lt;+86&gt;:    lea    0x10(%rsp),%rdi</span><br><span class="line">0x4010bd &lt;+91&gt;:    callq  0x401338 &lt;strings_not_equal&gt;</span><br><span class="line">0x4010c2 &lt;+96&gt;:    test   %eax,%eax</span><br><span class="line">0x4010c4 &lt;+98&gt;:    je     0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">0x4010c6 &lt;+100&gt;:   callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x4010cb &lt;+105&gt;:   nopl   0x0(%rax,%rax,1)</span><br><span class="line">0x4010d0 &lt;+110&gt;:   jmp    0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">0x4010d2 &lt;+112&gt;:   mov    $0x0,%eax</span><br><span class="line">0x4010d7 &lt;+117&gt;:   jmp    0x40108b &lt;phase_5+41&gt;</span><br><span class="line">0x4010d9 &lt;+119&gt;:   mov    0x18(%rsp),%rax</span><br><span class="line">0x4010de &lt;+124&gt;:   xor    %fs:0x28,%rax</span><br><span class="line">0x4010e7 &lt;+133&gt;:   je     0x4010ee &lt;phase_5+140&gt;</span><br><span class="line">0x4010e9 &lt;+135&gt;:   callq  0x400b30 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">0x4010ee &lt;+140&gt;:   add    $0x20,%rsp</span><br><span class="line">0x4010f2 &lt;+144&gt;:   pop    %rbx</span><br><span class="line">0x4010f3 &lt;+145&gt;:   retq</span><br></pre></td></tr></table></figure>
<p>A. 先阅读读入部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0x401062 &lt;+0&gt;:     push   %rbx</span><br><span class="line">0x401063 &lt;+1&gt;:     sub    $0x20,%rsp</span><br><span class="line">0x401067 &lt;+5&gt;:     mov    %rdi,%rbx</span><br><span class="line">0x40106a &lt;+8&gt;:     mov    %fs:0x28,%rax</span><br><span class="line">0x401073 &lt;+17&gt;:    mov    %rax,0x18(%rsp)</span><br><span class="line">0x401078 &lt;+22&gt;:    xor    %eax,%eax</span><br><span class="line">0x40107a &lt;+24&gt;:    callq  0x40131b &lt;string_length&gt;</span><br><span class="line">0x40107f &lt;+29&gt;:    cmp    $0x6,%eax</span><br><span class="line">0x401082 &lt;+32&gt;:    je     0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">0x401084 &lt;+34&gt;:    callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x401089 &lt;+39&gt;:    jmp    0x4010d2 &lt;phase_5+112&gt;</span><br></pre></td></tr></table></figure>
<p>寄存器 %rbx = %rdi = &amp;input，记录输入字符串的地址。</p>
<p>调用函数 string_length 计算输入 %rdi = &amp;input 的字符串长度，要求其长度为 6。</p>
<p>B. 上述代码跳转到 0x4010d2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x4010d2 &lt;+112&gt;:   mov    $0x0,%eax</span><br><span class="line">0x4010d7 &lt;+117&gt;:   jmp    0x40108b &lt;phase_5+41&gt;</span><br></pre></td></tr></table></figure>
<p>该段代码将 %eax 赋值为 0，并跳转到 0x40108b。</p>
<p>C. 0x40108b~0x4010ac 是一个循环，循环变量为 %rax=0~5，%rbx = &amp;input。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x40108b &lt;+41&gt;:    movzbl (%rbx,%rax,1),%ecx</span><br><span class="line">0x40108f &lt;+45&gt;:    mov    %cl,(%rsp)</span><br><span class="line">0x401092 &lt;+48&gt;:    mov    (%rsp),%rdx</span><br><span class="line">0x401096 &lt;+52&gt;:    and    $0xf,%edx</span><br></pre></td></tr></table></figure>
<p>上述代码取出 input 的字符，并将低 4 位赋值给 %edx，即 %edx = input[%rax] &amp; 0xf。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x401099 &lt;+55&gt;:    movzbl 0x4024b0(%rdx),%edx</span><br><span class="line">0x4010a0 &lt;+62&gt;:    mov    %dl,0x10(%rsp,%rax,1)</span><br></pre></td></tr></table></figure>
<p>上述代码从地址 0x4024b0 + %rdx 取值，并存储于栈 %rsp + %rax + 16 处。</p>
<p>使用 <code>print (char *) 0x4024b0</code> 查看该地址的值为 “maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?” 。</p>
<p>该循环利用上述字符串构造了新的字符串，并存储于起始地址 %rsp + 16。</p>
<p>D. 第 3 步构造的字符串要与地址 0x40245e 的字符串相同。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0x4010ae &lt;+76&gt;:    movb   $0x0,0x16(%rsp)</span><br><span class="line">0x4010b3 &lt;+81&gt;:    mov    $0x40245e,%esi</span><br><span class="line">0x4010b8 &lt;+86&gt;:    lea    0x10(%rsp),%rdi</span><br><span class="line">0x4010bd &lt;+91&gt;:    callq  0x401338 &lt;strings_not_equal&gt;</span><br><span class="line">0x4010c2 &lt;+96&gt;:    test   %eax,%eax</span><br><span class="line">0x4010c4 &lt;+98&gt;:    je     0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">0x4010c6 &lt;+100&gt;:   callq  0x40143a &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>使用 <code>print (char *) 0x40245e</code> 查看字符串，其值为 “flyers”。</p>
<p>E. 构造字符串的第 i 个字符为 *(0x4024b0 + (input[i] &amp; 0xf))，依据 “flyers” 可反向推导 input 的值为 0x9fe567。然而 input 是作为字符串读入的，因此值 0x9fe567 要构造成可打印字符的序列。本文将每个值或（or）上 0x60，构造出序列 “ionefg”。</p>
<p>“ionefg” 即为 bomb 的第 5 组运行参数。</p>
<h3 id="phase-6"><a href="#phase-6" class="headerlink" title="phase_6"></a>phase_6</h3><p>A. 数据读入使用 read_six_numbers：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x401100 &lt;+12&gt;:    mov    %rsp,%r13</span><br><span class="line">0x401103 &lt;+15&gt;:    mov    %rsp,%rsi</span><br><span class="line">0x401106 &lt;+18&gt;:    callq  0x40145c &lt;read_six_numbers&gt;</span><br><span class="line">0x40110b &lt;+23&gt;:    mov    %rsp,%r14</span><br></pre></td></tr></table></figure>
<p>在 phase_2 已知 read_six_numbes 读取六个整数，依次存储于 %rsi, %rsi + 4, …, %rsi + 20。</p>
<p>定义 <code>int a[6]</code>，其中 a = %rsi，则六个整数可表示为 a[0], a[1], …, a[5]。</p>
<p>B. 二重循环检测六个整数的大小关系，要求<strong>两两不同</strong>且每个数不能大于 6。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x401114 &lt;+32&gt;:    mov    %r13,%rbp</span><br><span class="line">...</span><br><span class="line">0x40114d &lt;+89&gt;:    add    $0x4,%r13</span><br><span class="line">0x401151 &lt;+93&gt;:    jmp    0x401114 &lt;phase_6+32&gt;</span><br></pre></td></tr></table></figure>
<p>寄存器 %r13 为外层循环指针，依次指向 &amp;a[0], &amp;a[1], …, &amp;a[5]。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x40110e &lt;+26&gt;:    mov    $0x0,%r12d</span><br><span class="line">...</span><br><span class="line">0x401128 &lt;+52&gt;:    add    $0x1,%r12d</span><br><span class="line">0x40112c &lt;+56&gt;:    cmp    $0x6,%r12d</span><br><span class="line">0x401130 &lt;+60&gt;:    je     0x401153 &lt;phase_6+95&gt;</span><br><span class="line">0x401132 &lt;+62&gt;:    mov    %r12d,%ebx</span><br></pre></td></tr></table></figure>
<p>寄存器 %r12 为外层循环下标，依次赋值为 0, 1, …, 5。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x401132 &lt;+62&gt;:    mov    %r12d,%ebx</span><br><span class="line">0x401135 &lt;+65&gt;:    movslq %ebx,%rax</span><br><span class="line">...</span><br><span class="line">0x401145 &lt;+81&gt;:    add    $0x1,%ebx</span><br><span class="line">0x401148 &lt;+84&gt;:    cmp    $0x5,%ebx</span><br><span class="line">0x40114b &lt;+87&gt;:    jle    0x401135 &lt;phase_6+65&gt;</span><br></pre></td></tr></table></figure>
<p>寄存器 %ebx 为内层循环下标。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x401117 &lt;+35&gt;:    mov    0x0(%r13),%eax			# %eax = a[i]</span><br><span class="line">0x40111b &lt;+39&gt;:    sub    $0x1,%eax</span><br><span class="line">0x40111e &lt;+42&gt;:    cmp    $0x5,%eax</span><br><span class="line">0x401121 &lt;+45&gt;:    jbe    0x401128 &lt;phase_6+52&gt;</span><br><span class="line">0x401123 &lt;+47&gt;:    callq  0x40143a &lt;explode_bomb&gt;	# bomb if a[i] &gt; 6</span><br></pre></td></tr></table></figure>
<p>上述代码检查 a[i] - 1 &lt;= 5 是否满足，不满足则调用 explode_bomb。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x401135 &lt;+65&gt;:    movslq %ebx,%rax</span><br><span class="line">0x401138 &lt;+68&gt;:    mov    (%rsp,%rax,4),%eax		# %eax = a[j]</span><br><span class="line">0x40113b &lt;+71&gt;:    cmp    %eax,0x0(%rbp)			</span><br><span class="line">0x40113e &lt;+74&gt;:    jne    0x401145 &lt;phase_6+81&gt;</span><br><span class="line">0x401140 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;	# bomb if a[i] == a[j]</span><br></pre></td></tr></table></figure>
<p>%ebx 为内层循环下标，因此 %eax = a[j]。</p>
<p>%rsp = %r13 为外层循环指针，因此 cmp 指令比较 a[i], a[j]。</p>
<p>上述代码检测 a[i] != a[j]，不满足则调用 explode_bomb。</p>
<p>C. 更新 a[i] = 7 - a[i]。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0x401153 &lt;+95&gt;:    lea    0x18(%rsp),%rsi			# 循环上界 %rsp + 24</span><br><span class="line">0x401158 &lt;+100&gt;:   mov    %r14,%rax					# 循环指针 %rax</span><br><span class="line">0x40115b &lt;+103&gt;:   mov    $0x7,%ecx</span><br><span class="line">0x401160 &lt;+108&gt;:   mov    %ecx,%edx</span><br><span class="line">0x401162 &lt;+110&gt;:   sub    (%rax),%edx</span><br><span class="line">0x401164 &lt;+112&gt;:   mov    %edx,(%rax)				# *%rax = 7 - *%rax</span><br><span class="line">0x401166 &lt;+114&gt;:   add    $0x4,%rax</span><br><span class="line">0x40116a &lt;+118&gt;:   cmp    %rsi,%rax</span><br><span class="line">0x40116d &lt;+121&gt;:   jne    0x401160 &lt;phase_6+108&gt;</span><br></pre></td></tr></table></figure>
<p>%rax 是指向数组 a 的指针，因此上述代码完成 a[i] = 7 - a[i]。</p>
<p>D. 构造 value 指针数组，第 i 个 value 指针指向 0x6032d0 + 16(a[i] - 1)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x40116f &lt;+123&gt;:   mov    $0x0,%esi			# %esi 为偏移量 4i</span><br><span class="line">...</span><br><span class="line">0x40118d &lt;+153&gt;:   add    $0x4,%rsi</span><br><span class="line">0x401191 &lt;+157&gt;:   cmp    $0x18,%rsi</span><br></pre></td></tr></table></figure>
<p>寄存器 %esi 为偏移量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x401176 &lt;+130&gt;:   mov    0x8(%rdx),%rdx</span><br><span class="line">0x40117a &lt;+134&gt;:   add    $0x1,%eax</span><br><span class="line">0x40117d &lt;+137&gt;:   cmp    %ecx,%eax</span><br><span class="line">0x40117f &lt;+139&gt;:   jne    0x401176 &lt;phase_6+130&gt;</span><br><span class="line">0x401181 &lt;+141&gt;:   jmp    0x401188 &lt;phase_6+148&gt;</span><br><span class="line">0x401183 &lt;+143&gt;:   mov    $0x6032d0,%edx</span><br></pre></td></tr></table></figure>
<p>上述代码根据 %ecx = a[i] 值，使用 %rdx = *(%rdx + 8) 构造 value 指针，%rdx 初始地址为 0x6032d0。</p>
<p>利用 <code>print *(int *) 0x6032d0</code> 查询一系列地址的值，可得下表：</p>
<p><table style="border-collapse:collapse;border-spacing:0;border-color:#ccc" class="tg"><tr><th style="font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#ffffff;background-color:#fd6864;text-align:center;vertical-align:top">addr</th><th style="font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#ffffff;background-color:#fd6864;text-align:center;vertical-align:top">value</th></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">0x6032d0</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">332</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x6032d8</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x6032e0</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">‬0x6032e0</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">‬168</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">‬0x6032e8</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x6032f0‬</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">0x6032f0‬</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">924</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x6032f8</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x603300</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">0x603300</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">691</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x603308</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x603310</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">0x603310</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">477</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x603318</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#fff;text-align:center;vertical-align:top">0x603320</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">0x603320</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-top-width:1px;border-bottom-width:1px;border-color:inherit;color:#333;background-color:#f9f9f9;text-align:center;vertical-align:top">443</td></tr></table><br>根据代码以及上述表格可得，%rdx = 0x6032d0 + 16 * (a[i] - 1)。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x401188 &lt;+148&gt;:   mov    %rdx,0x20(%rsp,%rsi,2)</span><br></pre></td></tr></table></figure>
<p>%rsi 为第 i 个元素的偏移量，值为 4i。</p>
<p>value 指针数组的起始地址为 %rsp + 32，第 i 个整数的 value 指针地址为 %rsp + 32 + 8i，存储值 %rdx = 0x6032d0 + 16 * (a[i] - 1)。</p>
<p>E. 构造六个元素的链表。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x4011b0 &lt;+188&gt;:   lea    0x28(%rsp),%rax</span><br><span class="line">...</span><br><span class="line">0x4011c4 &lt;+208&gt;:   add    $0x8,%rax</span><br><span class="line">0x4011c8 &lt;+212&gt;:   cmp    %rsi,%rax</span><br></pre></td></tr></table></figure></p>
<p>寄存器 %rax 是指向 value 指针数组的指针，从第 2 个元素开始。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0x4011ab &lt;+183&gt;:   mov    0x20(%rsp),%rbx</span><br><span class="line">0x4011ba &lt;+198&gt;:   mov    %rbx,%rc</span><br><span class="line">0x4011bd &lt;+201&gt;:   mov    (%rax),%rdx</span><br><span class="line">0x4011c0 &lt;+204&gt;:   mov    %rdx,0x8(%rcx)</span><br><span class="line">...</span><br><span class="line">0x4011cd &lt;+217&gt;:   mov    %rdx,%rcx</span><br><span class="line">0x4011d0 &lt;+220&gt;:   jmp    0x4011bd &lt;phase_6+201&gt;</span><br></pre></td></tr></table></figure>
<p>第 i 个元素的 next 指针地址为 <em>(%rcx + 8)，而 %rcx = value[i]，因此 next 的地址等于 </em>(value[i] + 8) = 0x6032d0 + 16 <em> (a[i] - 1) + 8，该地址存储 </em>(%rax) 的值 = value[i + 1] =  0x6032d0 + 16 * (a[i + 1] - 1)。</p>
<p>即该链表顺序链接，第 i 个元素的下一个元素为第 i + 1 个元素。</p>
<p>F. 遍历构造链表并比较相邻元素的大小。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x4011da &lt;+230&gt;:   mov    $0x5,%ebp</span><br><span class="line">...</span><br><span class="line">0x4011f2 &lt;+254&gt;:   sub    $0x1,%ebp</span><br><span class="line">0x4011f5 &lt;+257&gt;:   jne    0x4011df &lt;phase_6+235&gt;</span><br></pre></td></tr></table></figure>
<p>%ebp 存储循环下标。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x4011df &lt;+235&gt;:   mov    0x8(%rbx),%rax</span><br></pre></td></tr></table></figure>
<p>%rbx = value[i]，因此 %rax = *(value[i] + 8) = next + i。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x4011e3 &lt;+239&gt;:   mov    (%rax),%eax</span><br></pre></td></tr></table></figure>
<p>从 *(&amp;next[i]) = value[i + 1] 的地址取值并存于 %eax，即 %eax = value[i + 1]。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x4011e5 &lt;+241&gt;:   cmp    %eax,(%rbx)</span><br><span class="line">0x4011e7 &lt;+243&gt;:   jge    0x4011ee &lt;phase_6+250&gt;</span><br><span class="line">0x4011e9 &lt;+245&gt;:   callq  0x40143a &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>cmp 指令比较 value[i + 1] 和 value[i]。</p>
<p>当 value[i] &lt; value[i + 1] 不发生跳转，从而顺序执行 explode_bomb。所以，链表的元素需要满足单调递减的性质。</p>
<p>查询第 4 步中的表可得，链表序列为 924 691 477 443 332 168，对应的 a[i] 序列为 3 4 5 6 1 2。注意第 3 步中用 7 - a[i] 更新了 a[i] 数组，因此原始的 a[i] 序列为 4 3 2 1 6 5。</p>
<p>“4 3 2 1 6 5” 为 bomb 的第 6 组运行参数。</p>
<h3 id="答案"><a href="#答案" class="headerlink" title="答案"></a>答案</h3><p>Border relations with Canada have never been better.<br>1 2 4 8 16 32<br>7 327<br>7 0<br>ionefg<br>4 3 2 1 6 5</p>

    </article>
    <!-- license  -->
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "../../19/CSAPP-attacklab/" title= "CSAPP - attacklab">
                    <div class="nextTitle">CSAPP - attacklab</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "../../14/CSAPP-datalab/" title= "CSAPP - datalab">
                    <div class="prevTitle">CSAPP - datalab</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    

    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
<div id="gitalk-container"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
	const gitalk = new Gitalk({
		clientID: '38ea5d8ced7dd6f7499f',
		clientSecret: 'ec2ab733801f235f78cd1d8016be50f7b92dd808',
		repo: 'mcginn7.github.io',
		owner: 'mcginn7',
		admin: ['mcginn7'],
		id: location.pathname,      // Ensure uniqueness and length less than 50
		distractionFreeMode: false  // Facebook-like distraction free mode
	})
	gitalk.render('gitalk-container')
</script>


    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:mingqinchen@foxmail.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/mcginn7" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>

    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-GDB"><span class="toc-number">1.</span> <span class="toc-text">安装 GDB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#问题一"><span class="toc-number">1.1.</span> <span class="toc-text">问题一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题二"><span class="toc-number">1.2.</span> <span class="toc-text">问题二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目"><span class="toc-number">2.</span> <span class="toc-text">题目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-1"><span class="toc-number">2.1.</span> <span class="toc-text">phase_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-2"><span class="toc-number">2.2.</span> <span class="toc-text">phase_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-3"><span class="toc-number">2.3.</span> <span class="toc-text">phase_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-4"><span class="toc-number">2.4.</span> <span class="toc-text">phase_4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-5"><span class="toc-number">2.5.</span> <span class="toc-text">phase_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-6"><span class="toc-number">2.6.</span> <span class="toc-text">phase_6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#答案"><span class="toc-number">2.7.</span> <span class="toc-text">答案</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 29
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2021 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/12</span><a class="archive-post-title" href= "" >SGU-351-400</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/27</span><a class="archive-post-title" href= "../../../06/27/SGU-301-350-ChenMingqin.work/" >SGU-301-350</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/27</span><a class="archive-post-title" href= "../../../06/27/SGU-301-350/" >SGU-301-350</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/13</span><a class="archive-post-title" href= "../../../06/13/Deep-Retrieval/" >Deep Retrieval</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/24</span><a class="archive-post-title" href= "../../../04/24/SGU-253-300/" >SGU-253-300</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/06</span><a class="archive-post-title" href= "../../../../2020/10/06/SGU-153-252/" >SGU 153-252</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/10</span><a class="archive-post-title" href= "../../../../2020/05/10/Kuhn-Munkres-Algorithm/" >Kuhn-Munkres Algorithm</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span><a class="archive-post-title" href= "../../../../2020/02/23/CSAPP-cachelab/" >CSAPP - cachelab</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/21</span><a class="archive-post-title" href= "../../../../2020/02/21/CSAPP-archlab/" >CSAPP - archlab</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/19</span><a class="archive-post-title" href= "../../../../2020/02/19/CSAPP-attacklab/" >CSAPP - attacklab</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/16</span><a class="archive-post-title" href= "../../../../2020/02/16/CSAPP-bomblab/" >CSAPP - bomblab</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/14</span><a class="archive-post-title" href= "../../../../2020/02/14/CSAPP-datalab/" >CSAPP - datalab</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/20</span><a class="archive-post-title" href= "../../../../2019/11/20/Palindromic-Factorization/" >回文分解算法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/15</span><a class="archive-post-title" href= "../../../../2019/11/15/SGU-100-152/" >SGU 100~152</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/31</span><a class="archive-post-title" href= "../../../../2019/10/31/polya/" >Pólya计数法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/22</span><a class="archive-post-title" href= "../../../../2019/07/22/B-Tree/" >B-Tree</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/31</span><a class="archive-post-title" href= "../../../../2019/05/31/AhoCorasick-Algorithm/" >AhoCorasick Algorithm</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/24</span><a class="archive-post-title" href= "../../../../2019/05/24/Knuth-Morris-Pratt-Algorithm/" >Knuth-Morris-Pratt Algorithm</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "../../../../2019/05/12/ICPC-Resolver-踩坑/" >ICPC Resolver 踩坑</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/03</span><a class="archive-post-title" href= "../../../../2019/04/03/斜率优化/" >斜率优化</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/31</span><a class="archive-post-title" href= "../../../../2019/03/31/Nowcoder-出题人的数组/" >Nowcoder-出题人的数组</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/10</span><a class="archive-post-title" href= "../../../../2018/10/10/Vim-for-windows-配置/" >Windows 下使用 Vim</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/09</span><a class="archive-post-title" href= "../../../../2018/10/09/论文笔记-Tips-and-Tricks-for-Visual-Question-Answering/" >论文笔记 Tips and Tricks for Visual Question Answering</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span><a class="archive-post-title" href= "../../../../2018/10/04/DOMjudge配置/" >DOMjudge 配置</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/18</span><a class="archive-post-title" href= "../../../../2018/08/18/论文笔记 Semantic Compositional Networks for Visual Captioning/" >论文笔记 Semantic Compositional Networks for Visual Captioning</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/19</span><a class="archive-post-title" href= "../../../../2018/07/19/The Binding of Isaac Afterbirth+总结-ChenMingqin.work/" >The Binding of Isaac:Afterbirth+总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/19</span><a class="archive-post-title" href= "../../../../2018/07/19/The Binding of Isaac Afterbirth+总结/" >The Binding of Isaac:Afterbirth+总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/17</span><a class="archive-post-title" href= "../../../../2018/07/17/论文阅读记录/" >论文阅读记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/05</span><a class="archive-post-title" href= "../../../../2018/06/05/apt-offline管理Ubuntu离线安装软件包/" >Ubuntu离线安装软件包</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="AhoCorasick"><span class="iconfont-archer">&#xe606;</span>AhoCorasick</span>
    
        <span class="sidebar-tag-name" data-tags="AC自动机"><span class="iconfont-archer">&#xe606;</span>AC自动机</span>
    
        <span class="sidebar-tag-name" data-tags="KMP"><span class="iconfont-archer">&#xe606;</span>KMP</span>
    
        <span class="sidebar-tag-name" data-tags="domjudge"><span class="iconfont-archer">&#xe606;</span>domjudge</span>
    
        <span class="sidebar-tag-name" data-tags="ICPC"><span class="iconfont-archer">&#xe606;</span>ICPC</span>
    
        <span class="sidebar-tag-name" data-tags="贪心"><span class="iconfont-archer">&#xe606;</span>贪心</span>
    
        <span class="sidebar-tag-name" data-tags="DR"><span class="iconfont-archer">&#xe606;</span>DR</span>
    
        <span class="sidebar-tag-name" data-tags="vim"><span class="iconfont-archer">&#xe606;</span>vim</span>
    
        <span class="sidebar-tag-name" data-tags="git bash"><span class="iconfont-archer">&#xe606;</span>git bash</span>
    
        <span class="sidebar-tag-name" data-tags="polya"><span class="iconfont-archer">&#xe606;</span>polya</span>
    
        <span class="sidebar-tag-name" data-tags="斜率优化"><span class="iconfont-archer">&#xe606;</span>斜率优化</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "Mcginn"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="../../../../lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="../../../../scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="../../../../scripts/share.js" async></script>    
     
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>


